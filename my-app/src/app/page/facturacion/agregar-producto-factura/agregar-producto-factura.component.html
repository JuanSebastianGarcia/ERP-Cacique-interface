<!-- ========================================
     MODAL PARA AGREGAR PRODUCTOS A FACTURA
     ======================================== -->
<div class="modal-overlay active">
  <div class="modal-container modal-compact">
    
    <!-- ========================================
         HEADER DEL MODAL - T√çTULO PRINCIPAL
         ======================================== -->
    <div class="modal-header-bar">
      <h3 class="modal-title-bar">Agregar producto</h3>
    </div>
    
    <!-- ========================================
         CUERPO PRINCIPAL DEL MODAL
         ======================================== -->
    <div class="modal-body">
      
      <!-- ========================================
           SECCI√ìN DE FILTROS - LISTAS DESPLEGABLES
           ======================================== -->
      <div class="select-grid">
        <!-- Filtro por tipo de prenda -->
        <div class="select-group">
          <label class="select-label">Prenda</label>
          <select class="form-select compact-select" [(ngModel)]="producto.prenda" name="prenda" required (change)="onFiltroChange()">
            <option value="">Selecciona una prenda</option>
            <option *ngFor="let item of prendas" [value]="item">{{ item }}</option>
          </select>
        </div>

        <!-- Filtro por talla -->
        <div class="select-group">
          <label class="select-label">Talla</label>
          <select class="form-select compact-select" [(ngModel)]="producto.talla" name="talla" required (change)="onFiltroChange()">
            <option value="">Selecciona una talla</option>
            <option *ngFor="let item of tallas" [value]="item">{{ item }}</option>
          </select>
        </div>

        <!-- Filtro por instituci√≥n -->
        <div class="select-group">
          <label class="select-label">Instituci√≥n</label>
          <select class="form-select compact-select" [(ngModel)]="producto.institucion" name="institucion" required (change)="onFiltroChange()">
            <option value="">Selecciona una instituci√≥n</option>
            <option *ngFor="let item of instituciones" [value]="item">{{ item }}</option>
          </select>
        </div>

        <!-- Filtro por g√©nero -->
        <div class="select-group">
          <label class="select-label">G√©nero</label>
          <select class="form-select compact-select" [(ngModel)]="producto.genero" name="genero" required (change)="onFiltroChange()">
            <option value="">Selecciona un g√©nero</option>
            <option *ngFor="let item of generos" [value]="item">{{ item }}</option>
          </select>
        </div>

        <!-- Filtro por horario -->
        <div class="select-group">
          <label class="select-label">Horario</label>
          <select class="form-select compact-select" [(ngModel)]="producto.horario" name="horario" required (change)="onFiltroChange()">
            <option value="">Selecciona un horario</option>
            <option *ngFor="let item of horarios" [value]="item">{{ item }}</option>
          </select>
        </div>
      </div>

      <!-- ========================================
           SECCI√ìN DE PRODUCTOS DISPONIBLES
           ======================================== -->
      <div class="products-section">
        
        <!-- Header de la secci√≥n de productos -->
        <div class="products-header">
          <h4 class="products-title">üì¶ Productos Disponibles</h4>
          <!-- Botones para cambiar vista (Grid/Tabla) -->
          <div class="view-toggle">
            <button type="button" class="view-btn active" (click)="toggleView('grid')">‚öè</button>
          </div>
        </div>

        
        <!-- ========================================
             VISTA EN GRID - TARJETAS DE PRODUCTOS
             ======================================== -->
        <div class="products-grid" *ngIf="currentView === 'grid'">
          <!-- Iteraci√≥n de productos en formato de tarjetas -->
          <div class="product-card" *ngFor="let product of productosDisponibles">
            
            <!-- Header de la tarjeta - Nombre, instituci√≥n y precio -->
            <div class="product-header">
              <div>
                <div class="product-name">{{ product.prenda }}</div>
                <div class="product-institution">{{ product.institucion }}</div>
              </div>
              <div class="product-price">{{ product.precio | currency:'COP':'symbol':'1.0-0' }}</div>
            </div>
            
            <!-- Atributos del producto - Talla, horario, g√©nero -->
            <div class="product-attributes">
              <div class="product-attribute"><strong>Talla:</strong> {{ product.talla }}</div>
              <div class="product-attribute"><strong>Horario:</strong> {{ product.horario }}</div>
              <div class="product-attribute"><strong>G√©nero:</strong> {{ product.genero }}</div>
            </div>
            
            <!-- Indicador de stock disponible -->
            <div class="stock-indicator">
              <span class="stock-badge" [ngClass]="getStockClass(product.cantidad)">
                {{ product.cantidad }} en stock
              </span>
            </div>
            
            <!-- Acciones del producto - Bot√≥n simple para agregar -->
            <div class="product-actions">
              <!-- Bot√≥n simple para agregar producto -->
              <button type="button" class="add-to-cart-btn" (click)="agregarProducto(product.id)">
                üõí Agregar
              </button>
            </div>
          </div>
        </div>

        
        <!-- ========================================
             FOOTER - RESUMEN Y ACCIONES
             ======================================== -->
        <div class="selection-summary">
          <!-- Informaci√≥n de productos seleccionados -->
          <div class="selection-info">
            <div class="selection-count">{{ productosSeleccionados.size }} productos seleccionados</div>
            <div class="selection-details" *ngIf="productosSeleccionados.size > 0">
              {{ getTotalUnidades() }} unidades total
            </div>
          </div>
          <!-- Botones de acci√≥n -->
          <div class="footer-actions">
            <button type="button" class="btn btn-secondary" (click)="cancelar()">
              Cancelar
            </button>
            <button type="button" class="btn btn-primary" (click)="agregar()" [disabled]="productosSeleccionados.size === 0">
              Agregar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  